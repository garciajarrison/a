<!DOCTYPE html>
<ui:composition template="common/template.xhtml"
   xmlns="http://www.w3c.org/1999/xhtml"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:p="http://primefaces.org/ui"
   xmlns:ui="http://java.sun.com/jsf/facelets">

	<ui:define name="content">

		<h1>#{msg['cotizacion']}</h1>
		<br />
		
		<div class="ui-g">
			<p:commandButton value="#{msg['cotizacion.btn.nueva']}" id="btnNuevo"   styleClass="ui-priority-primary" process="@this" update=":formulario:aCotizacion:infCoti, :formulario:aCotizacion:infCLie, :formulario:aCotizacion:infRemit, :formulario:aCotizacion:jnfProp, :formulario:aCotizacion:infResult">
				<p:ajax event="click" listener="#{cotizacionAdmBB.nuevaCotizacion}"/>
			</p:commandButton>

			<p:commandButton id="btnConsulta"  value="#{msg['cotizacion.btn.consulta']}" immediate="true"  >
				<p:ajax event="click" listener="#{cotizacionAdmBB.consultar}"   ></p:ajax>
			</p:commandButton>
         		<p:commandButton value="#{msg['cotizacion.btn.calcular']}" type="button"  >	          				          		
					 <p:ajax  listener="#{cotizacionAdmBB.cotizar}"  process="@all" update=" :formulario:aCotizacion:infCoti, :formulario:aCotizacion:infCLie, :formulario:aCotizacion:infRemit,  :formulario:aCotizacion:infResult"/>
				</p:commandButton>
				<p:commandButton value="#{msg['btn.guardar']}" type="button"  >	          				          		
					 <p:ajax  listener="#{cotizacionAdmBB.guardar}"  process="@all" update="aCotizacion"/>
				</p:commandButton>
				
				<p:commandButton value="#{msg['btn.descargar']}" ajax="false" 
						onclick="PrimeFaces.monitorDownload(start, stop);" 
						actionListener="#{cotizacionAdmBB.generarReporteCotizacion}"
						icon="ui-icon-arrowthick-1-s" immediate="true">
			        <p:fileDownload value="#{cotizacionAdmBB.file}" />
			    </p:commandButton>

		</div>
		
		<p:accordionPanel id="aCotizacion">
			<p:tab title="#{msg['cotizacion.tab.cotizacion']}">
	          	<p:panel id="infCoti" style="background:none;" >

					<div class="ui-g">
			        	<div class="ui-g-12 ui-md-6 ui-lg-3">
				 			<p:outputLabel id="lId" value="#{msg['cotizacion.id']}" for="txtId" styleClass="aval-label"/><font/>
				   		</div>
			   			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtId" value="#{cotizacionAdmBB.cotizacion.id}" disabled="true"
					   				styleClass="form-control col-md-7 col-xs-12">
					   		</p:inputText>
				   		</div>
	   				
	          		
			        	<div class="ui-g-12 ui-md-6 ui-lg-3" >
				 			<p:outputLabel id="lFecha" value="#{msg['cotizacion.fecha']}" for="txtFecha" styleClass="aval-label" required="true" /><font/>
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:calendar id="txtFecha" value="#{cotizacionAdmBB.cotizacion.fecha}" showOn="button" title="#{msg['licencia.ultimo.pago']}"
					   			navigator="true" pattern="yyyy-MM-dd"	required="true" >
					   			
					   		</p:calendar>
					   		
				   		</div>
					<div class="ui-g-12 ui-md-6 ui-lg-3">
 					<p:outputLabel id="lPais" value="#{msg['cotizacion.pais']}:" for="selPais"  styleClass="aval-label"></p:outputLabel>	
 					</div>
 					<div class="ui-g-12 ui-md-6 ui-lg-3">		
			   		<p:selectOneMenu id="selPais" value="#{cotizacionAdmBB.paisCot}" style="width:180px"
			   						 title="#{msg['cotizacion.ciudad']}"  filter="true"
			   						label="#{msg['cotizacion.ciudad']}">
			   			<p:ajax listener="#{cotizacionAdmBB.onPaisChange(cotizacionAdmBB.paisCot)}" process="selDepartamento, selPais" update="selDepartamento" />
			           <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaPais}" />
			        </p:selectOneMenu> 
			        </div>
			        <div class="ui-g-12 ui-md-6 ui-lg-3">
			        <p:outputLabel id="lDepartamento" value="#{msg['cotizacion.departamento']}:" for="selDepartamento"  styleClass="aval-label"></p:outputLabel>
			        </div>
			        <div class="ui-g-12 ui-md-6 ui-lg-3">	    				
			   		<p:selectOneMenu id="selDepartamento" value="#{cotizacionAdmBB.dpto}" style="width:180px"
			   						 title="#{msg['cotizacion.departamento']}"  filter="true"
			   						label="#{msg['cotizacion.departamento']}">			   		
			   			<p:ajax listener="#{cotizacionAdmBB.onDepartamentoChange(cotizacionAdmBB.dpto)}" process="selCiudad,selDepartamento" update="selCiudad" />				
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaDepartamento}" />
			        </p:selectOneMenu>
			        </div>
			        <div class="ui-g-12 ui-md-6 ui-lg-3">
			        <p:outputLabel id="lCiudad" value="#{msg['cotizacion.ciudad']}:" for="selCiudad"  styleClass="aval-label"></p:outputLabel>	
			        </div>
			        <div class="ui-g-12 ui-md-6 ui-lg-3">		
			   		<p:selectOneMenu id="selCiudad" value="#{cotizacionAdmBB.cotizacion.ciudad.id}" style="width:180px"
			   						 title="#{msg['cotizacion.ciudad']}"  filter="true"
			   						label="#{msg['cotizacion.ciudad']}">
			   			
			           <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaCiudad}" />
			        </p:selectOneMenu> 
					</div>
				   		
				   
				   		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   			<p:outputLabel id="lEstado" value="#{msg['cotizacion.estado']}" for="selEstado" styleClass="aval-label"></p:outputLabel>
					   	</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:selectOneMenu id="selEstado" value="#{cotizacionAdmBB.cotizacion.estado}" style="width:180px" required="true" 
					   						 title="#{msg['cotizacion.estado']}"  filter="true"
					   						label="#{msg['cotizacion.estado']}">					   		
					            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
					            <f:selectItem itemLabel="Aprobado" itemValue="APROBA" />
					            <f:selectItem itemLabel="Rechazado" itemValue="RECHAZ" />
					            <f:selectItem itemLabel="Pendiente" itemValue="PENDIE" />
					            <f:selectItem itemLabel="Inactiva" itemValue="INACTI" />
					        </p:selectOneMenu> 		
				   		</div>
				   		
				   		<div class="ui-g-12 ui-md-6 ui-lg-3" >
				 			<p:outputLabel id="lMotivo" value="#{msg['cotizacion.motivo']}" for="txtMotivo" styleClass="aval-label" /><font/>
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputTextarea id="txtMotivo" value="#{cotizacionAdmBB.cotizacion.motivo}" required="true" 
					   				styleClass="form-control col-md-7 col-xs-12">					   			
					   		</p:inputTextarea>
				   		</div>
				   		        	<div class="ui-g-12 ui-md-6 ui-lg-3">
				 			<p:outputLabel id="lTotal"  value="#{msg['cotizacion.total']}" for="txtTotalCot"  styleClass="aval-label"/><font/>
				   		</div>
			   			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtTotalCot" value="#{cotizacionAdmBB.cotizacion.valor}" disabled="true" style="align:rigth"
					   				styleClass="form-control col-md-7 col-xs-12">
					   				<f:convertNumber pattern="$#,##0.00" currencySymbol="$" />
					   		</p:inputText>
					   	</div>	

				   	</div>
		   			
   				</p:panel>
	        </p:tab>		
	        <p:tab title="#{msg['cotizacion.tab.cliente']}">
	          	<p:panel id="infCLie" style="background:none;" >

	          		<div class="ui-g">
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
	          				<p:outputLabel id="tipoPersona" value="#{msg['cotizacion.tipo.persona']}" for="selTipoPers" styleClass="aval-label"/>
	          			</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
	          				<p:selectOneMenu id="selTipoPers" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.tipoPersona}" required="true" style="width:180px">
								<p:ajax event="change" update="infCLie" process="infCLie"/>
								<f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
					            <f:selectItem itemLabel="Natural" itemValue="PNATUR" />
					            <f:selectItem itemLabel="Juridica" itemValue="PJURID" />			
				        	</p:selectOneMenu>
	          			</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
	          				<p:outputLabel id="tipoIden" value="#{msg['cotizacion.tipo.identificacion']}" for="selTipoIdent" styleClass="aval-label"/>
	          			</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
	          				<p:selectOneMenu id="selTipoIdent" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.tipoDocumento}" style="width:180px"  >
					            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
					            <f:selectItems value="#{cotizacionAdmBB.listaTipoDocumentos}" />			
				        	</p:selectOneMenu>
	          			</div>
				   		
			        	<div class="ui-g-12 ui-md-6 ui-lg-3" >
				 			<p:outputLabel id="lIdentificacion" value="#{(cotizacionAdmBB.cotizacion.usuarioByClienteId.tipoPersona eq 'PJURID')?  msg['cotizacion.rut'] : msg['cotizacion.identificacion']}" for="txtIdentificacion" styleClass="aval-label" /><font/>
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtIdentificacion" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.identificacion}" 
					   				styleClass="form-control col-md-7 col-xs-12">
					   			<p:ajax event="change" listener="#{cotizacionAdmBB.onconsultaCliente(cotizacionAdmBB.cotizacion.usuarioByClienteId.tipoDocumento, cotizacionAdmBB.cotizacion.usuarioByClienteId.identificacion)}" update="infCLie" process="infCLie"  ></p:ajax>
					   		</p:inputText>
				   		</div>
				   		
				   		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   			<p:outputLabel id="lName" value="#{(cotizacionAdmBB.cotizacion.usuarioByClienteId.tipoPersona eq 'PJURID')?  msg['cotizacion.razon'] : msg['cotizacion.nombre']}" for="txtName" styleClass="aval-label"/>
					   	</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtName" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.nombre}" 
					   				styleClass="form-control col-md-7 col-xs-12"/>  		
				   		</div>

				   		<div class="ui-g-12 ui-md-6 ui-lg-3" >
				   			<p:outputLabel id="lApellido1" value="#{msg['cotizacion.apellido1']}" for="txtApell1" styleClass="aval-label"/>
					   	</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtApell1" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.apellido1}" 
					   				styleClass="form-control col-md-7 col-xs-12"/>  		
				   		</div>
				   						   		
				   		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   			<p:outputLabel id="lApellido2" value="#{msg['cotizacion.apellido2']}" for="txtApell2" styleClass="aval-label"/>
					   	</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtApell2" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.apellido2}" 
					   				styleClass="form-control col-md-7 col-xs-12"/>  		
				   		</div>

				   		<div class="ui-g-12 ui-md-6 ui-lg-3"> 
			 	   			<p:outputLabel id="lPhone" value="#{msg['cotizacion.telefono']}" for="txtPhone" styleClass="aval-label" />
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtPhone" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.telefono}" 
					   				styleClass="form-control col-md-7 col-xs-12" />  	
				   		</div>
				   		
				   		<div class="ui-g-12 ui-md-6 ui-lg-3">			
			 	   			<p:outputLabel id="lCelular" value="#{msg['cotizacion.celular']}" for="txtCelular" styleClass="aval-label"/>
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtCelular" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.celular}"
					   				styleClass="form-control col-md-7 col-xs-12"/>  
				   		</div>
				   		
				   		<div class="ui-g-12 ui-md-6 ui-lg-3">				
			 	   			<p:outputLabel id="lAddress" value="#{msg['cotizacion.direccion']}" for="txtAddress" styleClass="aval-label"/>
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtAddress" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.direccion}"  
					   				styleClass="form-control col-md-7 col-xs-12"/> 
				   		</div>
				   		
				   		<div class="ui-g-12 ui-md-6 ui-lg-3">		 		
			 	   			<p:outputLabel id="lEmail" value="#{msg['cotizacion.correo']}" for="txtEmail" styleClass="aval-label"/>
				   		</div>
	          			<div class="ui-g-12 ui-md-6 ui-lg-3">
					   		<p:inputText id="txtEmail" value="#{cotizacionAdmBB.cotizacion.usuarioByClienteId.correo}"
					   			validatorMessage="Correo electronico incorrecto ..." styleClass="form-control col-md-7 col-xs-12">
					   			<f:validateRegex 
										pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
					   		</p:inputText>  
				   		</div>
				   		
				   		<div class="ui-g-12" align="center">
					   		<p:commandButton value="#{msg['cotizacion.btn.agrcliente']}" type="button">
					   		   <p:ajax event="click" listener="#{cotizacionAdmBB.addCliente('infCLie')}" process="infCLie" update="infCLie"/>
					   		</p:commandButton>
				   		</div>
				   	</div>
		   			
   				</p:panel>
	        </p:tab>
	        <p:tab title="#{msg['cotizacion.tab.remitente']}">
				<p:panel id="infRemit" style="background:none;" >
	          		<div class="ui-g">
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:outputLabel id="tipoIdenR" value="#{msg['cotizacion.tipo.identificacion']}" for="selTipoIdentR" styleClass="aval-label"/>
				   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:selectOneMenu id="selTipoIdentR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.tipoDocumento}" required="true"  style="width:180px">
				            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
				            <f:selectItems value="#{cotizacionAdmBB.listaTipoDocumentos}" />			
			        	</p:selectOneMenu> 
			        </div>
	          			
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				 		<p:outputLabel id="lIdentificacionR" value="#{msg['cotizacion.identificacion']}" for="txtIdentificacionR" styleClass="aval-label"/>
				   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:inputText id="txtIdentificacionR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.identificacion}"
				   					 styleClass="form-control col-md-7 col-xs-12" >
				   			<p:ajax event="change" listener="#{cotizacionAdmBB.onconsultaRemitente(cotizacionAdmBB.cotizacion.usuarioByRemitenteId.tipoDocumento, cotizacionAdmBB.cotizacion.usuarioByRemitenteId.identificacion)}" update="infRemit" process="@this" ></p:ajax>

				   		</p:inputText>
				   	</div>
				   	
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:outputLabel id="lNameR" value="#{msg['cotizacion.nombre']}" for="txtNameR" styleClass="aval-label"/>
				   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:inputText id="txtNameR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.nombre}"  styleClass="form-control col-md-7 col-xs-12" />  		
				   	</div>
				   	
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
			 	   		<p:outputLabel id="lPhoneR" value="#{msg['cotizacion.telefono']}" for="txtPhoneR" styleClass="aval-label"/>
				   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:inputText id="txtPhoneR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.telefono}" styleClass="form-control col-md-7 col-xs-12" /> 
				   	</div>
				   	
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
			 	   		<p:outputLabel id="lCelularR" value="#{msg['cotizacion.celular']}" for="txtCelularR" styleClass="aval-label"/>
				   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:inputText id="txtCelularR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.celular}" styleClass="form-control col-md-7 col-xs-12" />  
				   	</div>
	          			
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">		
			 	   		<p:outputLabel id="lAddressR" value="#{msg['cotizacion.direccion']}" for="txtAddressR" styleClass="aval-label"/>
				   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
				   		<p:inputText id="txtAddressR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.direccion}" styleClass="form-control col-md-7 col-xs-12" />  
				   	</div>
				   	
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">
			 	   		<p:outputLabel id="lEmailR" value="#{msg['cotizacion.correo']}" for="txtEmailR" styleClass="aval-label"/>
			 	   	</div>
	          		<div class="ui-g-12 ui-md-6 ui-lg-3">	
				   		<p:inputText id="txtEmailR" value="#{cotizacionAdmBB.cotizacion.usuarioByRemitenteId.correo}" styleClass="form-control col-md-7 col-xs-12" 
				   						validatorMessage="Correo electronico incorrecto ..." >
				   							   			<f:validateRegex
										pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
					   		</p:inputText>  
				   		  
				   	</div>
				   		
				   	<div class="ui-g-12" align="center">	
				   		<p:commandButton value="#{msg['cotizacion.btn.agrremitente']}" type="button">
				   		   <p:ajax event="click" listener="#{cotizacionAdmBB.addRemitente('infRemit')}" process="infRemit" update="infRemit"/>
				   		</p:commandButton>
				   	</div>
				   	</div>
   				</p:panel>	        
	        
	        </p:tab>
	        
	        <p:tab title="#{msg['cotizacion.tab.Propiedad']}">
	          	<p:panel id="jnfProp">
	          	
	          		<h2>#{msg['cotizacion.lista']}</h2>
	          		<h:panelGrid columns="1" columnClasses="label, value">
	          			<p:commandButton value="#{msg['btn.agregar']}" type="button" onclick="PF('dlgPropiedad').show();" >	          				          		
							 <p:ajax event="click" listener="#{cotizacionAdmBB.limpiarPropiedad}"  process="jnfProp"/>
						</p:commandButton>
	          			<p:dataTable  rows="15" var="propiedad" value="#{cotizacionAdmBB.listaPropiedades}" 
								emptyMessage="#{msg['no.registros']}" reflow="true">
						    <p:column headerText="#{msg['cotizacion.tipo.propiedad']}">
						        <h:outputText value="#{propiedad.tablas.nombre}" />
						    </p:column>
						    
						    <p:column headerText="#{msg['cotizacion.tipo.vivienda']}">
						        <h:outputText value="#{propiedad.tipoPropiedad.tipoVivienda}" />
						    </p:column>
						    <p:column headerText="#{msg['cotizacion.registro']}">
						        <h:outputText value="#{propiedad.registro}" />
						    </p:column>
						 
						    <p:column headerText="#{msg['cotizacion.direccion']}">
						        <h:outputText value="#{propiedad.direccion}" />
						    </p:column>
						    
				    
						    
						    <p:column headerText="#{msg['cotizacion.unidad']}">
						        <h:outputText value="#{propiedad.unidadMedida}" />
						    </p:column>
						 
						    <p:column headerText="#{msg['cotizacion.area']}">
						        <h:outputText value="#{propiedad.valorMedida}" />
						    </p:column>						    
						    
						    <p:column headerText="#{msg['cotizacion.estrato']}">
						        <h:outputText value="#{propiedad.estrato.nombre}" />
						    </p:column>			
						    <p:column headerText="#{msg['acciones']}">
						    	<center>
							    	<p:splitButton value="#{msg['btn.actualizar']}" icon="ui-icon-disk">
								        <p:menuitem value="#{msg['btn.actualizar']}" actionListener="#{cotizacionAdmBB.editarPropiedad(propiedad)}"  
								        			update=":#{p:component('dlgActualizarP')}" oncomplete="PF('dlgActualizarP').show();"
								        			icon="ui-icon-arrowrefresh-1-w" >
								        	
								        </p:menuitem>
								        <p:menuitem value="#{msg['btn.borrar']}" actionListener="#{cotizacionAdmBB.editarPropiedad(propiedad)}" 
								        			update=":#{p:component('dlgEliminarP')}" oncomplete="PF('dlgEliminarP').show();"
								        			icon="ui-icon-close" >
								        </p:menuitem>
								    </p:splitButton>
						    	
								</center>
						    </p:column>			    
						    
						</p:dataTable>
	          			
	          		</h:panelGrid>
			    </p:panel>
			    
			    
	        </p:tab>
	        <p:tab title="#{msg['cotizacion.tab.resultado']}">
				<p:panel id="infResult" style="background:none;" >
	          		<h:panelGrid columns="2" columnClasses="label, value">	        
				<p:dataTable  rows="15" var="detalle" value="#{cotizacionAdmBB.listaDetCotizacion}" 
							editable="true" editMode="cell" reflow="true"
								emptyMessage="#{msg['no.registros']}">
					<p:ajax event="cellEdit" listener="#{cotizacionAdmBB.onCellEdit}" process=":formulario:aCotizacion:infCoti, :formulario:aCotizacion:infResult"  update=":formulario:aCotizacion:infCoti" />			
						    <p:column headerText="#{msg['cotizacion.tipo.propiedad']}">
						        <h:outputText value="#{detalle.propiedad.tablas.nombre}" />
						    </p:column>
						    
						    <p:column headerText="#{msg['cotizacion.tipo.vivienda']}">
						        <h:outputText value="#{detalle.propiedad.tipoPropiedad.tipoVivienda}" />
						    </p:column>
						    <p:column headerText="#{msg['cotizacion.registro']}">
						        <h:outputText value="#{detalle.propiedad.registro}" />
						    </p:column>
						 
						    <p:column headerText="#{msg['cotizacion.direccion']}">
						        <h:outputText value="#{detalle.propiedad.direccion}" />
						    </p:column>
						    
						    
						    
						    <p:column headerText="#{msg['cotizacion.valor']}">
						        
						        <p:cellEditor>
					               <f:facet name="output"><h:outputText value="#{detalle.valor}" >
					               			<f:convertNumber pattern="$#,##0.00" currencySymbol="$" />
					               </h:outputText>
					               </f:facet>
					               <f:facet name="input"><p:inputText value="#{detalle.valor}" style="width:96%" label="Valor">
					               					<f:convertNumber pattern="$#,##0.00" currencySymbol="$" />
					               </p:inputText>
					               </f:facet>
					           </p:cellEditor>
						    </p:column>						    
						    
						     
						    
						</p:dataTable>	
					
				</h:panelGrid>        
				
				</p:panel>
	        </p:tab>
	              
    	</p:accordionPanel>  

		<p:dialog header="#{msg['cotizacion.dialog.Propiedad']}" id="dlgPropiedad" widgetVar="dlgPropiedad" minHeight="40" width="50%">
				<h:panelGrid columns="2" width="95%" >
					<p:outputLabel id="lTable" value="#{msg['cotizacion.tabla']}:" for="selTables" ></p:outputLabel>
			   		<p:selectOneMenu tabindex="" id="selTables" value="#{cotizacionAdmBB.infPropiedad.tablas.id}" style="width:180px"
			   						title="#{msg['cotizacion.tabla']}"  filter="true"
			   						label="#{msg['cotizacion.tabla']}">
			   			<p:ajax listener="#{cotizacionAdmBB.onTableChange(cotizacionAdmBB.infPropiedad.tablas.id)}" process="selTables,selProperty" update="selProperty" />
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" /> 
			            <f:selectItems  value="#{cotizacionAdmBB.listaTablas}" />
			        </p:selectOneMenu>
		
			   		<p:outputLabel id="lProperty" value="#{msg['cotizacion.tipo.vivienda']}:" for="selProperty" ></p:outputLabel>
			   		<p:selectOneMenu id="selProperty" value="#{cotizacionAdmBB.infPropiedad.tipoPropiedad.id}" style="width:180px"
			   						 title="#{msg['cotizacion.tipo.vivienda']}"  filter="true"
			   						label="#{msg['cotizacion.tipo.vivienda']}">			   			
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaTipoPropiedad}" />
			        </p:selectOneMenu>		        	
			 		
			 		<p:outputLabel id="lMatricula" value="#{msg['cotizacion.registro']}:" for="txtMatricula" ></p:outputLabel>	
			 		<p:inputText id="txtMatricula" value="#{cotizacionAdmBB.infPropiedad.registro}"
			   						 title="#{msg['cotizacion.registro']}" 
			   						label="#{msg['cotizacion.registro']}"></p:inputText>	 
			 		<p:outputLabel id="lEstrato" value="#{msg['cotizacion.estrato']}:" for="selEstrato" ></p:outputLabel>			   		
			   		<p:selectOneMenu id="selEstrato" value="#{cotizacionAdmBB.infPropiedad.estrato.id}" style="width:180px"
			   						 title="#{msg['cotizacion.estrato']}"  filter="true"
			   						label="#{msg['cotizacion.estrato']}">
			   			
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaEstrato}" />
			        </p:selectOneMenu>  				        						
					
					<p:outputLabel id="lDireccion" value="#{msg['cotizacion.direccion']}:" for="txtDireccion"></p:outputLabel>
					<p:inputText id="txtDireccion" value="#{cotizacionAdmBB.infPropiedad.direccion}"></p:inputText>
					<p:commandButton value="#{msg['cotizacion.direccion']}"  type="button" onclick="PF('dlgDireccion').show();" icon="ui-icon-home">	          				          		
							 
					</p:commandButton>
						<p:outputLabel id="lDireccions" ></p:outputLabel>

			 		<p:outputLabel id="lUMedidad" value="#{msg['cotizacion.unidad']}:" for="selUMedida" ></p:outputLabel>	
				   		<p:selectOneMenu id="selUMedida" value="#{cotizacionAdmBB.infPropiedad.unidadMedida}" style="width:180px"
			   						 title="#{msg['cotizacion.unidad']}"  filter="true"
			   						label="#{msg['cotizacion.unidad']}">
				            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
				            <f:selectItems value="#{cotizacionAdmBB.listaUnidadMedida}" />			
			        	</p:selectOneMenu> 
			        <p:outputLabel id="lValorMedida" value="#{msg['cotizacion.area']}:" for="txtValorMedida" ></p:outputLabel>	
			 		<p:inputText id="txtValorMedida" value="#{cotizacionAdmBB.infPropiedad.valorMedida}"
			   						 title="#{msg['cotizacion.area']}"  filter="true"
			   						label="#{msg['cotizacion.area']}"></p:inputText>	 			 					        	        
			</h:panelGrid>
								<br/>
			
			       <h:panelGrid columns="3" >
			       
			     <div align="center">  
					
					<p:commandButton value="Agregar" type="button"  >
					<p:ajax event="click" listener="#{cotizacionAdmBB.addPropiedad}" process="dlgPropiedad" update=":formulario:aCotizacion:jnfProp, dlgPropiedad"/>
					</p:commandButton>
				</div>
			       </h:panelGrid>
		</p:dialog>
		
		<p:dialog header="#{msg['tipo.propiedad.actualizar']}" id="dlgDireccion" widgetVar="dlgDireccion" minHeight="40" >
			    
			 <p:panel header="Informacion via">
			 	<h:panelGrid columns="14"  > 
			 		<p:outputLabel id="lTipoVia" value="#{msg['cotizacion.tipo.via']}:" for="selTipoVia" ></p:outputLabel>	                  
                   <h:selectOneMenu id="selTipoVia" value="#{cotizacionAdmBB.direccion.tipoVia}" >
                   		<f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
                       <f:selectItems value="#{cotizacionAdmBB.listaTipoVia}" var="via" itemLabel="#{via}" itemValue="#{via}" />
                   </h:selectOneMenu>
      				
      			   <p:outputLabel id="lNombreVia" value="#{msg['cotizacion.nombre.via']}:" for="txtNombreVia" ></p:outputLabel>
                   <p:inputText id="txtNombreVia" value="#{cotizacionAdmBB.direccion.nombreVia}" style="width:96%"/>
      				
      				<p:outputLabel id="lNumeroVia" value="#{msg['cotizacion.numero.via']}:" for="txtNumeroVia" ></p:outputLabel>
               	   <p:inputText id="txtNumeroVia" value="#{cotizacionAdmBB.direccion.numeroVia}" style="width:46%"/>	
                   
     				<p:outputLabel id="lLetraVia" value="#{msg['cotizacion.letra.via']}:" for="txtLetraVia" ></p:outputLabel>
                   <p:inputText id="txtLetraVia" value="#{cotizacionAdmBB.direccion.letraVia}" style="width:46%"/>
         
                   <p:outputLabel id="lPrefijoVia" value="#{msg['cotizacion.prefijo.via']}:" for="txtPrefijoVia" ></p:outputLabel>
                   <p:inputText id="txtPrefijoVia" value="#{cotizacionAdmBB.direccion.letraVia}" style="width:46%"/>
  
     				<p:outputLabel id="lLetraVia2" value="#{msg['cotizacion.letra.via']}:" for="txtLetraVia2" ></p:outputLabel>
                   <p:inputText id="txtLetraVia2" value="#{cotizacionAdmBB.direccion.letraVia}" style="width:96%"/>
                  
                  <p:outputLabel id="lPosicionVia" value="#{msg['cotizacion.posicion.via']}:" for="selPosicionVia" ></p:outputLabel>
                   <h:selectOneMenu id="selPosicionVia" value="#{cotizacionAdmBB.direccion.posicionVia}" style="width:100%">
                   		<f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
                       <f:selectItems value="#{cotizacionAdmBB.listaPosicionVia}" var="via" itemLabel="#{via}" itemValue="#{via}" />
                   </h:selectOneMenu>
              </h:panelGrid>
 
    </p:panel>
    <p:panel header="Informacion interseccion" >
             <h:panelGrid columns="14"  > 
             		<p:outputLabel id="lNumInter3" value="#{msg['cotizacion.numero.via']}:" for="txtNumeroInter3" ></p:outputLabel>
                   <p:inputText id="txtNumeroInter3" value="#{cotizacionAdmBB.direccion.numeroInterseccion}" style="width:96%"/>
           
                   <p:outputLabel id="lLetraInter3" value="#{msg['cotizacion.letra.via']}:" for="txtLetraInter3" ></p:outputLabel>
                   <p:inputText id="txtLetraInter3" value="#{cotizacionAdmBB.direccion.letraInterseccion}" style="width:96%"/>
                             
                   <p:outputLabel id="lPosInter3" value="#{msg['cotizacion.sufijo.via']}:" for="selPosicionInter3" ></p:outputLabel>
                   <h:selectOneMenu id="selPosicionInter3" value="#{cotizacionAdmBB.direccion.posicionInterseccion}" style="width:100%">
                   		<f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
                       <f:selectItems value="#{cotizacionAdmBB.listaPosicionVia}" var="pos" itemLabel="#{pos}" itemValue="#{pos}" />
                   </h:selectOneMenu>
              
              		<p:outputLabel id="lLetraInter4" value="#{msg['cotizacion.letra.via']}:" for="iLetraInter4" ></p:outputLabel>
                   <p:inputText id="iLetraInter4" value="#{cotizacionAdmBB.direccion.letraInterseccion}" style="width:96%"/>
                               
                   <p:outputLabel id="lPosInte4" value="#{msg['cotizacion.posicion.via']}:" for="selPosicionInter4" ></p:outputLabel>            
                   <h:selectOneMenu id="selPosicionInter4" value="#{cotizacionAdmBB.direccion.posicionInterseccion}" style="width:100%">
                   		<f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
                       <f:selectItems value="#{cotizacionAdmBB.listaPosicionVia}" var="pos" itemLabel="#{pos}" itemValue="#{pos}" />
                   </h:selectOneMenu>
            
            		<p:outputLabel id="lNumInter4" value="#{msg['cotizacion.numero.via']}:" for="txtNumInter4" ></p:outputLabel>
                   <p:inputText id="txtNumInter4" value="#{cotizacionAdmBB.direccion.numeroUbicacion}" style="width:96%"/>
                      
                   <p:outputLabel id="lPosInter5" value="#{msg['cotizacion.posicion.via']}:" for="selPosicionInter5" ></p:outputLabel>         
                   <h:selectOneMenu id="selPosicionInter5" value="#{cotizacionAdmBB.direccion.posicionInterseccion}" style="width:100%">
                   		<f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
                       <f:selectItems value="#{cotizacionAdmBB.listaPosicionVia}" var="pos" itemLabel="#{pos}" itemValue="#{pos}" />
                   </h:selectOneMenu>
               </h:panelGrid>
			</p:panel>         
			 <p:panel header="Complemento">
			 	<h:panelGrid columns="4"  >
			 		<p:outputLabel id="lUrba" value="Urbanizacin:" for="selUrba" ></p:outputLabel>			
			   		<p:selectOneMenu id="selUrba" value="#{cotizacionAdmBB.direccion.tipoUrbanizacion}" style="width:180px"
			   						 title="Urbanizacin"  filter="true"
			   						label="Urbanizacin">
			           <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaUrbanizacion}" />
			        </p:selectOneMenu> 
			 		<p:outputLabel id="lDUrba" value="Descripcin urbanizacin:" for="txtDUrba" ></p:outputLabel>
			 		<p:inputTextarea id="txtDUrba" value="#{cotizacionAdmBB.direccion.tipoUrbanizacion}">
			 		</p:inputTextarea>			
			 	</h:panelGrid>
			 </p:panel>      	
			 <p:panel header="Ubicacion">
			 	<h:panelGrid columns="6"  >
			        <p:outputLabel id="lPais" value="#{msg['cotizacion.pais']}:" for="selPais" ></p:outputLabel>			
			   		<p:selectOneMenu id="selPais" value="#{cotizacionAdmBB.pais}" style="width:180px"
			   						 title="#{msg['cotizacion.ciudad']}"  filter="true"
			   						label="#{msg['cotizacion.ciudad']}">
			   			<p:ajax listener="#{cotizacionAdmBB.onPaisChange(cotizacionAdmBB.pais)}" process="selDepartamento, selPais" update="selDepartamento" />
			           <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaPais}" />
			        </p:selectOneMenu> 
			        <p:outputLabel id="lDepartamento" value="#{msg['cotizacion.departamento']}:" for="selDepartamento" ></p:outputLabel>	    				
			   		<p:selectOneMenu id="selDepartamento" value="#{cotizacionAdmBB.departamento}" style="width:180px"
			   						 title="#{msg['cotizacion.departamento']}"  filter="true"
			   						label="#{msg['cotizacion.departamento']}">			   		
			   			<p:ajax listener="#{cotizacionAdmBB.onDepartamentoChange(cotizacionAdmBB.departamento)}" process="selCiudad,selDepartamento" update="selCiudad" />				
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaDepartamento}" />
			        </p:selectOneMenu>
			        <p:outputLabel id="lCiudad" value="#{msg['cotizacion.ciudad']}:" for="selCiudad" ></p:outputLabel>			
			   		<p:selectOneMenu id="selCiudad" value="#{cotizacionAdmBB.infPropiedad.ciudad.id}" style="width:180px"
			   						 title="#{msg['cotizacion.ciudad']}"  filter="true"
			   						label="#{msg['cotizacion.ciudad']}">
			   			
			           <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaCiudad}" />
			        </p:selectOneMenu> 
			 	
			 	</h:panelGrid>
			 </p:panel>	 
				
				<div align="center">  
					
					<p:commandButton value="Aceptar" type="button"  >
					<p:ajax event="click"  process="dlgDireccion, :formulario:txtDireccion" update="dlgDireccion, :formulario:txtDireccion" listener="#{cotizacionAdmBB.almacenarDireccion}"/>
					</p:commandButton>
				</div>
		</p:dialog>

		<p:dialog header="#{msg['tipo.propiedad.actualizar']}" id="dlgActualizarP" widgetVar="dlgActualizarP" minHeight="40" width="50%">
				<h:panelGrid columns="2" width="95%" >
					<p:outputLabel id="lTable2" value="#{msg['cotizacion.tabla']}:" for="selTables2" ></p:outputLabel>
			   		<p:selectOneMenu tabindex="" id="selTables2" value="#{cotizacionAdmBB.infPropiedad.tablas.id}" style="width:180px"
			   						title="#{msg['cotizacion.tabla']}"  filter="true"
			   						label="#{msg['cotizacion.tabla']}">
			   			<p:ajax listener="#{cotizacionAdmBB.onTableChange(cotizacionAdmBB.infPropiedad.tablas.id)}" process="selTables,selProperty" update="selProperty" />
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" /> 
			            <f:selectItems  value="#{cotizacionAdmBB.listaTablas}" />
			        </p:selectOneMenu>
		
			   		<p:outputLabel id="lProperty2" value="#{msg['cotizacion.tipo.vivienda']}:" for="selProperty2" ></p:outputLabel>
			   		<p:selectOneMenu id="selProperty2" value="#{cotizacionAdmBB.infPropiedad.tipoPropiedad.id}" style="width:180px"
			   						 title="#{msg['cotizacion.tipo.vivienda']}"  filter="true"
			   						label="#{msg['cotizacion.tipo.vivienda']}">			   			
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaTipoPropiedad}" />
			        </p:selectOneMenu>		        	
			 		
			 		<p:outputLabel id="lMatricula2" value="#{msg['cotizacion.registro']}:" for="txtMatricula2" ></p:outputLabel>	
			 		<p:inputText id="txtMatricula2" value="#{cotizacionAdmBB.infPropiedad.registro}"
			   						 title="#{msg['cotizacion.registro']}" 
			   						label="#{msg['cotizacion.registro']}"></p:inputText>	 
			 		<p:outputLabel id="lEstrato2" value="#{msg['cotizacion.estrato']}:" for="selEstrato2" ></p:outputLabel>			   		
			   		<p:selectOneMenu id="selEstrato2" value="#{cotizacionAdmBB.infPropiedad.estrato.id}" style="width:180px"
			   						 title="#{msg['cotizacion.estrato']}"  filter="true"
			   						label="#{msg['cotizacion.estrato']}">
			   			
			            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
			            <f:selectItems value="#{cotizacionAdmBB.listaEstrato}" />
			        </p:selectOneMenu>  				        						
					
					<p:outputLabel id="lDireccion2" value="#{msg['cotizacion.direccion']}:" for="txtDireccion2"></p:outputLabel>
					<p:inputText id="txtDireccion2" value="#{cotizacionAdmBB.infPropiedad.direccion}"></p:inputText>
					<p:commandButton value="#{msg['cotizacion.direccion']}"  type="button" onclick="PF('dlgDireccion').show();" icon="ui-icon-home">	          				          		
							 
					</p:commandButton>
						<p:outputLabel id="lDireccions2" ></p:outputLabel>

			 		<p:outputLabel id="lUMedidad2" value="#{msg['cotizacion.unidad']}:" for="selUMedida2" ></p:outputLabel>	
				   		<p:selectOneMenu id="selUMedida2" value="#{cotizacionAdmBB.infPropiedad.unidadMedida}" style="width:180px"
			   						 title="#{msg['cotizacion.unidad']}"  filter="true"
			   						label="#{msg['cotizacion.unidad']}">
				            <f:selectItem itemLabel="#{msg['seleccione']}" itemValue="" />
				            <f:selectItems value="#{cotizacionAdmBB.listaUnidadMedida}" />			
			        	</p:selectOneMenu> 
			        <p:outputLabel id="lValorMedida2" value="#{msg['cotizacion.area']}:" for="txtValorMedida2" ></p:outputLabel>	
			 		<p:inputText id="txtValorMedida2" value="#{cotizacionAdmBB.infPropiedad.valorMedida}"
			   						 title="#{msg['cotizacion.area']}"  filter="true"
			   						label="#{msg['cotizacion.area']}"></p:inputText>	 			 					        	        
			</h:panelGrid>
								<br/>
			

			       <h:panelGrid columns="3" >
			       
			       
					
					<p:commandButton id="btnActPropiedadCot" value="#{msg['btn.actualizar']}" type="button"  >
					<p:ajax event="click" listener="#{cotizacionAdmBB.actualizarPropiedad}" process="dlgActualizarP" update=":formulario:aCotizacion:jnfProp, dlgActualizarP"/>
					</p:commandButton>
		       </h:panelGrid>
			  

		</p:dialog>		
				
		<p:dialog header="#{msg['estrato.eliminar.propiedad']}" id="dlgEliminarP" widgetVar="dlgEliminarP" minHeight="40">
			<div align="center">
				
				<strong>#{msg['confirmarcion.borrar']}</strong>
			
				<br /><br />
		   		<p:commandButton value="#{msg['btn.borrar']}" type="button">
					<p:ajax event="click" listener="#{cotizacionAdmBB.addPropiedad}" 
							update="formulario"/>   		
		   		</p:commandButton>
	   		</div>
		</p:dialog>	
		
		
		<p:dialog header="#{msg['cotizacion.dialog.cotizaciones']}" id="dlgCotizaciones" widgetVar="dlgCotizaciones" minHeight="40" >
				<h:panelGrid columns="2" >
				<p:dataTable id="tCoti" rows="15" var="cotizacion" value="#{cotizacionAdmBB.listaCotizaciones}" widgetVar="tCoti"
							  selectionMode="single" selection="#{cotizacionAdmBB.selectedCotizacion}" rowKey="#{cotizacion.id}"
								emptyMessage="#{msg['no.registros']}" reflow="true"> 
					<p:ajax event="rowSelect" listener="#{cotizacionAdmBB.onRowSelect}" oncomplete="PF('dlgCotizaciones').hide();" update=":formulario:aCotizacion:infCoti, :formulario:aCotizacion:infCLie, :formulario:aCotizacion:infRemit, :formulario:aCotizacion:jnfProp, :formulario:aCotizacion:infResult" />		
								
						    <p:column headerText="#{msg['cotizacion.id']}">
						        <h:outputText value="#{cotizacion.id}" />
						    </p:column>
						    <p:column headerText="#{msg['cotizacion.tipo.identificacion']}">
						        <h:outputText value="#{cotizacion.usuarioByClienteId.tipoDocumento}" />
						    </p:column>
						    
						    <p:column headerText="#{msg['cotizacion.identificacion']}">
						        <h:outputText value="#{cotizacion.usuarioByClienteId.identificacion}" />
						    </p:column>
						    <p:column headerText="#{msg['cotizacion.nombre']}">
						        <h:outputText value="#{cotizacion.usuarioByClienteId.nombre}" />
						    </p:column>
						 
						    <p:column headerText="#{msg['cotizacion.valor']}">
						        <h:outputText value="#{cotizacion.valor}" >
						        	<f:convertNumber pattern="$###,###,##0.00" currencySymbol="$" />
						        </h:outputText>
						    </p:column>
						    
				    
						    
						     
						    
						</p:dataTable>	

			       </h:panelGrid>
		</p:dialog>
   </ui:define>
</ui:composition>